<script src="https://cartodb-libs.global.ssl.fastly.net/carto.js/v4.1.10/carto.min.js"></script>
<script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js"></script>
    <link href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css" rel="stylesheet">
<link rel="stylesheet" href="https://libs.cartocdn.com/cartodb.js/v3/3.15/themes/css/cartodb.css" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<div id="mapContainer"></div>
<div id ="layerSelectionContainer">
<div class="dropdown">
<!-- this button style is from the Bootstrap library -->
  <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    Choose another data series...
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu scrollable-menu" id="layer-selector" aria-labelledby="dropdownMenuDivider">

    <li data-url="https://cci-displacement.carto.com/api/v2/viz/0e10d6e3-e205-4a34-88cf-176b72271e6a/viz.json" class="active">
    <a href="#">Displacement typologies</a></li>

    <li role="separator" class="divider"></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/787c6988-47bd-11e5-8eca-0e853d047bba/viz.json">
    <a href="#">Basemap only</a></li>

    <li data-url="https://cci-displacement.carto.com/api/v2/viz/009acead-2c2a-4703-907c-e52f7cb51004/viz.json">
    <a href="#">Commercial Tracts</a></li>

    <li data-url="https://cci-displacement.carto.com/api/v2/viz/47a66364-580e-475e-a166-c221e4134c62/viz.json">
    <a href="#">Commercial Gentrification</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/3949b4a2-31a4-11e5-aeae-0e9d821ea90d/viz.json">
    <a href="#">Population (2013)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/2b46eec6-31c5-11e5-b5ff-0e0c41326911/viz.json">
    <a href="#">Housing units in pre-1950 buildings (%, 2013)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/5fa529e4-31c5-11e5-ba97-0e4fddd5de28/viz.json">
    <a href="#">Change in LI households w/ low rent burden (#, 2000-2013)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/1f194bfc-31c6-11e5-904c-0e4fddd5de28/viz.json">
    <a href="#">Employment density: jobs per square mile (2011)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/6cd76982-31c6-11e5-9b93-0e853d047bba/viz.json">
    <a href="#">Change in median home sale price (%, 2000-2013)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/d966d7ea-31c6-11e5-a76b-0e0c41326911/viz.json">
    <a href="#">Change in rent (%, 2000-2013)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/1d9cf94e-31c7-11e5-9940-0e0c41326911/viz.json">
    <a href="#">New market-rate units (#, 2000-2013)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/7b22760c-31c7-11e5-8946-0e4fddd5de28/viz.json">
    <a href="#">Change in low-income households (#, 2000-2013)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/b35ae3ba-31c7-11e5-86fe-0e9d821ea90d/viz.json">
    <a href="#">Change in % low-income in-migration (2009-2013)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/dff21f10-31c7-11e5-93e1-0e4fddd5de28/viz.json">
    <a href="#">Population growth (%, 2000-2013)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/23b35814-3596-11e5-8339-0e9d821ea90d/viz.json">
    <a href="#">Low-income households (%, 1990)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/b84a87a4-3596-11e5-8787-0e853d047bba/viz.json">
    <a href="#">Low-income households (%, 2000)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/dbc86c1e-3596-11e5-a30c-0e4fddd5de28/viz.json">
    <a href="#">Low-income households (%, 2013)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/f582fb24-3596-11e5-b01c-0e853d047bba/viz.json">
    <a href="#">Adults (25+) with college degree (%, 1990)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/1c78891a-3597-11e5-8f88-0e9d821ea90d/viz.json">
    <a href="#">Adults (25+) with college degree (%, 2000)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/49de57cc-3597-11e5-8339-0e9d821ea90d/viz.json">
    <a href="#">Adults (25+) with college degree (%, 2013)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/71dc8adc-3597-11e5-add1-0e4fddd5de28/viz.json">
    <a href="#">Renter households (%, 1990)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/aa69d72e-3597-11e5-a122-0e853d047bba/viz.json">
    <a href="#">Renter households (%, 2000)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/c4cc9962-3597-11e5-8f88-0e9d821ea90d/viz.json">
    <a href="#">Renter households (%, 2013)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/ee8cbdfe-3597-11e5-9ae6-0e018d66dc29/viz.json">
    <a href="#">Non-white population (%, 1990)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/07284b80-3598-11e5-8dd3-0e018d66dc29/viz.json">
    <a href="#">Non-white population (%, 2000)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/2d3006d8-3598-11e5-87fb-0e0c41326911/viz.json">
    <a href="#">Non-white population (%, 2013)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/4a2c93a0-3598-11e5-add1-0e4fddd5de28/viz.json">
    <a href="#">Change in college-educated adult population (%, 1990-2000)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/7342885c-3599-11e5-9ae6-0e018d66dc29/viz.json">
    <a href="#">Change in college-educated adult population (%, 2000-2013)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/9c73c1aa-3599-11e5-acd8-0e4fddd5de28/viz.json">
    <a href="#">Median household income (1990)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/becd2fca-3599-11e5-9dbf-0e0c41326911/viz.json">
    <a href="#">Median household income (2000)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/ea62cdc0-3599-11e5-9c5d-0e018d66dc29/viz.json">
    <a href="#">Median household income (2013)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/10f600a6-359a-11e5-adcc-0e9d821ea90d/viz.json">
    <a href="#">Change in median household income (%, 1990-2000)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/3250f9fe-359a-11e5-a343-0e853d047bba/viz.json">
    <a href="#">Change in median household income (%, 2000-2013)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/5267e5b8-359a-11e5-87fb-0e0c41326911/viz.json">
    <a href="#">Market-rate units as % of new building (1990-2000)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/8b414852-359a-11e5-9435-0e4fddd5de28/viz.json">
    <a href="#">Market-rate units as % of new building (2000-2013)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/a3819c32-359a-11e5-ab62-0e9d821ea90d/viz.json">
    <a href="#">Change in median home sale price (%, 1990-2000)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/f3360c86-359a-11e5-a343-0e853d047bba/viz.json">
    <a href="#">Change in median home sale price (%, 2000-2013)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/1dedc96e-359b-11e5-ae41-0e853d047bba/viz.json">
    <a href="#">Change in median home value (%, 1990-2000)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/4b905f62-359b-11e5-ae41-0e853d047bba/viz.json">
    <a href="#">Change in median home value (%, 2000-2013)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/7492b086-359b-11e5-84af-0e0c41326911/viz.json">
    <a href="#">Gentrified between 1990 and 2000</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/fad41612-359b-11e5-8f88-0e9d821ea90d/viz.json">
    <a href="#">Gentrified between 2000 and 2013</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/330fa92e-359c-11e5-9c5d-0e018d66dc29/viz.json">
    <a href="#">Low-income in-migration (%, 2009)</a></li>

    <li data-url="https://cci-displacement.cartodb.com/api/v2/viz/5eaa5c82-359c-11e5-8bf3-0e4fddd5de28/viz.json">
    <a href="#">Low-income in-migration (%, 2013)</a></li>

  </ul>
</div>
</div>
<div id ="geoSelectionContainer">
<div class="dropdown">
<!-- this button style is from the Bootstrap library -->
  <!-- <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    Limit by city or county...
    <span class="caret"></span>
  </button> -->
  <ul class="dropdown-menu scrollable-menu" id="geo-selector" aria-labelledby="dropdownMenuDivider">
    <li data-geo="all" class="active"><a href="#">SHOW ALL</a></li>
    <li role="separator" class="divider"></li>
    <li data-geo="county" data-value="Alameda"><a href="#">Alameda County</a></li>
    <li data-geo="county" data-value="Contra Costa"><a href="#">Contra Costa County</a></li>
    <li data-geo="county" data-value="Marin"><a href="#">Marin County</a></li>
    <li data-geo="county" data-value="Napa"><a href="#">Napa County</a></li>
    <li data-geo="county" data-value="San Francisco"><a href="#">San Francisco County</a></li>
    <li data-geo="county" data-value="San Mateo"><a href="#">San Mateo County</a></li>
    <li data-geo="county" data-value="Santa Clara"><a href="#">Santa Clara County</a></li>
    <li data-geo="county" data-value="Solano"><a href="#">Solano County</a></li>
    <li data-geo="county" data-value="Sonoma"><a href="#">Sonoma County</a></li>
    <li role="separator" class="divider"></li>
    <li data-geo="city"><a href="#">Alameda</a></li>
    <li data-geo="city"><a href="#">Alameda County Unincorporated</a></li>
    <li data-geo="city"><a href="#">Albany</a></li>
    <li data-geo="city"><a href="#">American Canyon</a></li>
    <li data-geo="city"><a href="#">Antioch</a></li>
    <li data-geo="city"><a href="#">Atherton</a></li>
    <li data-geo="city"><a href="#">Belmont</a></li>
    <li data-geo="city"><a href="#">Belvedere</a></li>
    <li data-geo="city"><a href="#">Benicia</a></li>
    <li data-geo="city"><a href="#">Berkeley</a></li>
    <li data-geo="city"><a href="#">Brentwood</a></li>
    <li data-geo="city"><a href="#">Brisbane</a></li>
    <li data-geo="city"><a href="#">Burlingame</a></li>
    <li data-geo="city"><a href="#">Calistoga</a></li>
    <li data-geo="city"><a href="#">Campbell</a></li>
    <li data-geo="city"><a href="#">Clayton</a></li>
    <li data-geo="city"><a href="#">Cloverdale</a></li>
    <li data-geo="city"><a href="#">Colma</a></li>
    <li data-geo="city"><a href="#">Concord</a></li>
    <li data-geo="city"><a href="#">Contra Costa County Unincorporated</a></li>
    <li data-geo="city"><a href="#">Corte Madera</a></li>
    <li data-geo="city"><a href="#">Cotati</a></li>
    <li data-geo="city"><a href="#">Cupertino</a></li>
    <li data-geo="city"><a href="#">Daly City</a></li>
    <li data-geo="city"><a href="#">Danville</a></li>
    <li data-geo="city"><a href="#">Dixon</a></li>
    <li data-geo="city"><a href="#">Dublin</a></li>
    <li data-geo="city"><a href="#">East Palo Alto</a></li>
    <li data-geo="city"><a href="#">El Cerrito</a></li>
    <li data-geo="city"><a href="#">Emeryville</a></li>
    <li data-geo="city"><a href="#">Fairfax</a></li>
    <li data-geo="city"><a href="#">Fairfield</a></li>
    <li data-geo="city"><a href="#">Foster City</a></li>
    <li data-geo="city"><a href="#">Fremont</a></li>
    <li data-geo="city"><a href="#">Gilroy</a></li>
    <li data-geo="city"><a href="#">Half Moon Bay</a></li>
    <li data-geo="city"><a href="#">Hayward</a></li>
    <li data-geo="city"><a href="#">Healdsburg</a></li>
    <li data-geo="city"><a href="#">Hercules</a></li>
    <li data-geo="city"><a href="#">Hillsborough</a></li>
    <li data-geo="city"><a href="#">Lafayette</a></li>
    <li data-geo="city"><a href="#">Larkspur</a></li>
    <li data-geo="city"><a href="#">Livermore</a></li>
    <li data-geo="city"><a href="#">Los Altos</a></li>
    <li data-geo="city"><a href="#">Los Altos Hills</a></li>
    <li data-geo="city"><a href="#">Los Gatos</a></li>
    <li data-geo="city"><a href="#">Marin County Unincorporated</a></li>
    <li data-geo="city"><a href="#">Martinez</a></li>
    <li data-geo="city"><a href="#">Menlo Park</a></li>
    <li data-geo="city"><a href="#">Mill Valley</a></li>
    <li data-geo="city"><a href="#">Millbrae</a></li>
    <li data-geo="city"><a href="#">Milpitas</a></li>
    <li data-geo="city"><a href="#">Monte Sereno</a></li>
    <li data-geo="city"><a href="#">Moraga</a></li>
    <li data-geo="city"><a href="#">Morgan Hill</a></li>
    <li data-geo="city"><a href="#">Mountain View</a></li>
    <li data-geo="city"><a href="#">Napa</a></li>
    <li data-geo="city"><a href="#">Napa County Unincorporated</a></li>
    <li data-geo="city"><a href="#">Newark</a></li>
    <li data-geo="city"><a href="#">Novato</a></li>
    <li data-geo="city"><a href="#">Oakland</a></li>
    <li data-geo="city"><a href="#">Oakley</a></li>
    <li data-geo="city"><a href="#">Orinda</a></li>
    <li data-geo="city"><a href="#">Pacifica</a></li>
    <li data-geo="city"><a href="#">Palo Alto</a></li>
    <li data-geo="city"><a href="#">Petaluma</a></li>
    <li data-geo="city"><a href="#">Piedmont</a></li>
    <li data-geo="city"><a href="#">Pinole</a></li>
    <li data-geo="city"><a href="#">Pittsburg</a></li>
    <li data-geo="city"><a href="#">Pleasant Hill</a></li>
    <li data-geo="city"><a href="#">Pleasanton</a></li>
    <li data-geo="city"><a href="#">Portola Valley</a></li>
    <li data-geo="city"><a href="#">Redwood City</a></li>
    <li data-geo="city"><a href="#">Richmond</a></li>
    <li data-geo="city"><a href="#">Rio Vista</a></li>
    <li data-geo="city"><a href="#">Rohnert Park</a></li>
    <li data-geo="city"><a href="#">Ross</a></li>
    <li data-geo="city"><a href="#">San Anselmo</a></li>
    <li data-geo="city"><a href="#">San Bruno</a></li>
    <li data-geo="city"><a href="#">San Carlos</a></li>
    <li data-geo="city"><a href="#">San Francisco</a></li>
    <li data-geo="city"><a href="#">San Jose</a></li>
    <li data-geo="city"><a href="#">San Leandro</a></li>
    <li data-geo="city"><a href="#">San Mateo</a></li>
    <li data-geo="city"><a href="#">San Mateo County Unincorporated</a></li>
    <li data-geo="city"><a href="#">San Pablo</a></li>
    <li data-geo="city"><a href="#">San Rafael</a></li>
    <li data-geo="city"><a href="#">San Ramon</a></li>
    <li data-geo="city"><a href="#">Santa Clara</a></li>
    <li data-geo="city"><a href="#">Santa Clara County Unincorporated</a></li>
    <li data-geo="city"><a href="#">Santa Rosa</a></li>
    <li data-geo="city"><a href="#">Saratoga</a></li>
    <li data-geo="city"><a href="#">Sausalito</a></li>
    <li data-geo="city"><a href="#">Sebastopol</a></li>
    <li data-geo="city"><a href="#">Solano County Unincorporated</a></li>
    <li data-geo="city"><a href="#">Sonoma</a></li>
    <li data-geo="city"><a href="#">Sonoma County Unincorporated</a></li>
    <li data-geo="city"><a href="#">South San Francisco</a></li>
    <li data-geo="city"><a href="#">St. Helena</a></li>
    <li data-geo="city"><a href="#">Suisun City</a></li>
    <li data-geo="city"><a href="#">Sunnyvale</a></li>
    <li data-geo="city"><a href="#">Tiburon</a></li>
    <li data-geo="city"><a href="#">Union City</a></li>
    <li data-geo="city"><a href="#">Vacaville</a></li>
    <li data-geo="city"><a href="#">Vallejo</a></li>
    <li data-geo="city"><a href="#">Walnut Creek</a></li>
    <li data-geo="city"><a href="#">Windsor</a></li>
    <li data-geo="city"><a href="#">Woodside</a></li>
    <li data-geo="city"><a href="#">Yountville</a></li>  </ul>
</div>
</div>
<div class="expand-map">
	<a onclick="expandMap();" class="btn btn-primary">
		Larger <span class="glyphicon glyphicon-chevron-down"></span> Map</a></div>
<script>

// set the initial map options and url here
var INITIAL_MAP_SETTINGS = {
	detectRetina: true,
	center_lat: 37.8,
	center_lon: -122.3,
	zoom: 11
}
var INITIAL_VISJSON_URL = $('#layer-selector .active').data('url');

// state variables
var activeVis = null;
var baseQuery = null; // default for layer
var activeQuery = null; // geo selection if any
var activeCityName = null;
var activeCityOutline = null;

function getVisLayer() {
	// returns the CartoDB visualization layer
	var layers = activeVis.getLayers();
	return layers[1].getSubLayer(0);
}

function setUpMap(visjsonURL, mapSettings) {
	$("#mapContainer").append("<div id='map'></div>");
	cartodb.createVis('map', visjsonURL, mapSettings)
		.done(function(vis, layers) {
			activeVis = vis;
			// save default sql query and apply county selection if needed
			baseQuery = getVisLayer().getSQL();
			// replicate prior geo selection
			if (activeQuery) getVisLayer().setSQL(activeQuery);
			if (activeCityName) addCityOutline(activeCityName);
			// set custom text for search box, and remove when user clicks
			var textBox = $("#map .cartodb-searchbox .text");
			var defaultTxt = 'Go to place';
			textBox.val(defaultTxt);
			textBox.click(function() {
				if ($(this).val() == defaultTxt) $(this).val('');
			});
		});
}

$('#layer-selector li').click(function() {
	var url = $(this).data('url');
	var lmap = activeVis.getNativeMap();
	var activeMapSettings = {
		detectRetina: true,
		center_lat: lmap.getCenter().lat,
		center_lon: lmap.getCenter().lng,
		zoom: lmap.getZoom()
	}
	activeVis.remove();
	setUpMap(url, activeMapSettings);
	resetMenu($(this));
});

$('#geo-selector li').click(function() {
	clearCityOutline();
	var geo = $(this).data('geo'); // 'city' or 'county' or 'all'
	var selection = $(this).text(); // name of drop-down item
	var query = baseQuery;
	if (geo == 'county') {
		var value = $(this).data('value');
		query += " WHERE _county = '" + value + "'";
	}
	// San Fran county data includes Farallon Islands; map looks better if we select city instead
	if (selection == 'San Francisco County') {
		query = baseQuery + " WHERE _city = 'San Francisco'";
	}
	if (geo == 'city') {
		query += " WHERE _city = '" + selection + "'";
		addCityOutline(selection);
	}
	if (geo != 'all')
		zoomToExtent(query);

    // apply the query and save it in case the layer is changed
    getVisLayer().setSQL(query);
	activeQuery = query;
	resetMenu($(this));
});

function zoomToExtent(query) {
	var sql = new cartodb.SQL({user: 'cci-displacement'});
	sql.getBounds(query).done(function(bounds) {
        activeVis.getNativeMap().fitBounds(bounds);
    });
}

function addCityOutline(name) {
	activeCityName = name;
	activeCityOutline = activeVis.getLayers()[1].createSubLayer({
		sql: "SELECT * FROM bay_area_places_clean_v2 WHERE name = '" + name + "'",
		cartocss: '#bay_area_places_clean_v2 { line-color: #000; line-width: 1.5;}'
	});
}

function clearCityOutline() {
	if (activeCityOutline) activeCityOutline.remove();
	activeCityName = null;
	activeCityOutline = null;
}

function resetMenu(obj) {
	// reset selection in a pulldown menu
	obj.parent().find('.active').removeClass('active');
	obj.addClass('active');
}

function expandMap() {
	$(window).scrollTop($("#preface-wrapper").position().top - 15);
	var h = $(window).height() - 75;
	$("#mapContainer").height(h);
	$("#map1").height(h);
	$("#map2").height(h);
	activeVis.getNativeMap().invalidateSize();
	$(".expand-map").html('<a onclick="contractMap();" class="btn btn-primary">Smaller <span class="glyphicon glyphicon-chevron-up"></span> Map');
}

function contractMap() {
	$(window).scrollTop(0);
	$("#mapContainer").height(450);
	activeVis.getNativeMap().invalidateSize();
	$(".expand-map").html('<a onclick="expandMap();" class="btn btn-primary">Larger <span class="glyphicon glyphicon-chevron-down"></span> Map');
}

window.onload = function() {
	setUpMap(INITIAL_VISJSON_URL, INITIAL_MAP_SETTINGS);
}

</script>
<style>
/* overrides default style for legends */
#map .cartodb-legend-stack {
	right: 30px;
	width: 300px;
}
#map .cartodb-legend-stack .cartodb-legend .legend-title {
	font-family: 'Open Sans', sans-serif;
	color: black;
	font-size: 12px;
	font-weight: bold;
	text-transform: none;
}
#map .cartodb-legend-stack .cartodb-legend li {
	font-family: 'Open Sans', sans-serif;
	color: black;
	font-size: 11px;
	font-weight: normal;
	text-transform: none;
}
#map .cartodb-legend-stack .cartodb-legend li .bullet {
	height: 10px;
	width: 10px;
}
#map div.cartodb-legend-stack div.cartodb-legend li.min {
	float: left;
	width: 20%;
	text-align: center;
}
#map div.cartodb-legend-stack div.cartodb-legend li.median {
	float: left;
	width: 60%;
	text-align: center;
}
#map div.cartodb-legend-stack div.cartodb-legend li.max {
	float: right;
	width: 20%;
	text-align: center;
}

/* add scrolling to bootstrap menus */
.scrollable-menu {
    height: auto;
    max-height: 450px;
    overflow-x: hidden;
}

@media only screen
and (max-width: 380px) {

	.mobile-hide {
		display: none;
	}
	#topBanner {
		display: none;
	}
	#mapContainer {
		height: 400px;
	}
	#policy-info {
		width: 90%;
		top: 350px;
		margin: 0 auto;
	}
	div .cartodb-legend-stack {
		visibility: hidden;
	}
	#layerSelectionContainer {
		display: none;
	}
	#geoSelectionContainer {
		display: none;
	}
	div.expand-map {
		display: none;
	}
}

</style>
